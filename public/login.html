<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="./img/SOCC.png" />
    <title>SOCC Night Walk</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script
      src="https://kit.fontawesome.com/825a35d965.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="./main.css" />
    <link rel="stylesheet" href="./login.css" />
  </head>
  <body class="bg-black text-white max-w-[500px] mx-auto">
    <div id="main" class="p-4 flex flex-col justify-between">
      <form
        id="form"
        class="flex flex-col items-center gap-5 w-full h-full justify-center"
      >
        <h1 class="text-2xl font-bold">Login</h1>
        <div>
          <label class="block text-gray-300 text-sm font-bold mb-2" for="email">
            Email
          </label>
          <input
            class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"
            id="email"
            type="email"
            name="email"
            placeholder="Email"
            required
          />
        </div>
        <div class="flex flex-col w-full items-center">
          <div id="err" class="text-red-500 text-sm mb-2">&nbsp;</div>
          <a
            href="./signup"
            class="text-white text-right text-xs underline ml-auto mb-6"
            >Need account? Sign up now!</a
          >
          <button
            type="submit"
            id="submit"
            class="bg-slate-500 w-1/2 text-center p-2 rounded-full"
          >
            Submit
          </button>
        </div>
      </form>
    </div>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
      document.getElementById("email").addEventListener("input", () => {
        document.getElementById("err").classList.add("opacity-0");
      });
      document.getElementById("form").addEventListener("submit", (e) => {
        e.preventDefault();
        var formData = new FormData();
        axios
          .post(`./login`, {
            email: document.getElementById("email").value,
          })
          .then((response) => {
            localStorage.setItem("userData", JSON.stringify(response.data[0]));
            window.location.href = "/";
          })
          .catch((error) => {
            console.log(error);
            document.getElementById("err").classList.remove("opacity-0");
            document.getElementById("err").innerText = JSON.parse(
              error.response.data
            ).message;
          });
      });
    </script>

    <script>
      function getAbsoluteHeight(el) {
        // Get the DOM Node if you pass in a string
        el = typeof el === "string" ? document.querySelector(el) : el;

        var styles = window.getComputedStyle(el);
        var margin =
          parseFloat(styles["marginTop"]) + parseFloat(styles["marginBottom"]);

        return Math.ceil(el.offsetHeight + margin);
      }
      var heightSum = 0;
      for (var ele of document.querySelectorAll(".measure")) {
        heightSum += getAbsoluteHeight(ele);
      }
      document.getElementById("main").style.height =
        getAbsoluteHeight(document.body) - heightSum + `px`;
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
